<script src="https://utteranc.es/client.js"
        repo="lewinkoon/hugo-comments"
        branch="main"
        issue-term="{{ .Title }}"
        label="comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

<script>
    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `${theme}`
                },
                'https://lewin.netlify.app'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://lewin.netlify.app') return;
        if (document.documentElement.dataset.color == "dark") {
            setUtterancesTheme("dark-blue")
        } else {
            setUtterancesTheme("boxy-light")
        }
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (e.detail == "dark") {
            setUtterancesTheme("dark-blue")
        } else {
            setUtterancesTheme("boxy-light")
        }
    })
</script>